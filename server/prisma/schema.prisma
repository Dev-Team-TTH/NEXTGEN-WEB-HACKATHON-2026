generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Users {
  userId String @id
  name   String
  email  String
}

model Products {
  productId      String   @id
  name           String
  price          Float
  rating         Float?
  stockQuantity  Int      @default(0)
  
  baseUnit       String   @default("Cái")
  largeUnit      String?
  conversionRate Int      @default(1)
  imageUrl       String?

  // --- THÊM 6 TRƯỜNG CHUẨN TẬP ĐOÀN ---
  purchasePrice  Float?   @default(0)
  status         String   @default("ACTIVE") // Trạng thái: ACTIVE, OUT_OF_STOCK, DISCONTINUED
  category       String?
  description    String?
  reorderPoint   Int      @default(10) // Mặc định dưới 10 là báo động
  location       String?  // Vị trí kho (VD: Dãy A - Kệ 3)

  InventoryTransactions InventoryTransaction[]
}

// BẢNG: Lịch sử Nhập/Xuất kho
model InventoryTransaction {
  transactionId String   @id @default(uuid())
  productId     String
  type          String   // "IN" (Nhập kho) hoặc "OUT" (Xuất kho)
  quantity      Int      
  note          String?  
  timestamp     DateTime @default(now())

  product       Products @relation(fields: [productId], references: [productId], onDelete: Cascade)
}

// Giữ lại chi phí để làm báo cáo Dashboard (VD: Chi phí bảo trì tài sản, phí vận chuyển)
model Expenses {
  expenseId String   @id
  category  String
  amount    Float
  timestamp DateTime
}

model ExpenseSummary {
  expenseSummaryId  String              @id
  totalExpenses     Float
  date              DateTime
  ExpenseByCategory ExpenseByCategory[]
}

model ExpenseByCategory {
  expenseByCategoryId String         @id
  expenseSummaryId    String
  category            String
  amount              BigInt
  date                DateTime
  expenseSummary      ExpenseSummary @relation(fields: [expenseSummaryId], references: [expenseSummaryId])
}

model Assets {
  assetId      String   @id @default(uuid())
  name         String
  category     String   // VD: Thiết bị điện tử, Nội thất, Phương tiện...
  status       String   // VD: Đang sử dụng, Sẵn sàng, Đang bảo trì
  assignedTo   String?  // Người hoặc phòng ban đang mượn/sử dụng
  purchaseDate DateTime
  price        Float
}